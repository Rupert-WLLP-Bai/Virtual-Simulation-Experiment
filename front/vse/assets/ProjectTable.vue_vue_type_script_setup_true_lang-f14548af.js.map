{"version":3,"file":"ProjectTable.vue_vue_type_script_setup_true_lang-f14548af.js","sources":["../../src/pages/table/ProjectTable.vue"],"sourcesContent":["<script lang=\"ts\" setup>\r\n  import { reactive, ref } from 'vue';\r\n  import {\r\n    PlusOutlined,\r\n    EditFilled,\r\n    UploadOutlined,\r\n    SaveOutlined,\r\n  } from '@ant-design/icons-vue';\r\n  import EditableCell from '@/components/editable-cell';\r\n  import { message } from 'ant-design-vue';\r\n  import { getBase64 } from '@/utils/file';\r\n\r\n  const columns = [\r\n    { title: 'COMPANIES', dataIndex: 'company' },\r\n    {\r\n      title: 'BUDGET',\r\n      dataIndex: 'budget',\r\n      customRender: ({ text }: any) => `$${text}`,\r\n    },\r\n    { title: 'STATUS', dataIndex: 'status' },\r\n    { title: 'COMPLETION', dataIndex: 'progress' },\r\n    { title: 'OPERATION', dataIndex: 'operation', width: 200, align: 'center' },\r\n  ];\r\n\r\n  type Project = {\r\n    logo?: string;\r\n    company?: string;\r\n    budget?: number;\r\n    status?: number;\r\n    progress?: number;\r\n    _edit?: boolean;\r\n  };\r\n\r\n  const projects = reactive<Array<Project>>([\r\n    {\r\n      logo: '/src/assets/logo/shopify.svg',\r\n      company: 'shopify',\r\n      budget: 1200,\r\n      status: 1,\r\n      progress: 90,\r\n    },\r\n    {\r\n      logo: '/src/assets/logo/atlassian.svg',\r\n      company: 'atlassian',\r\n      budget: 1200,\r\n      status: 1,\r\n      progress: 90,\r\n    },\r\n    {\r\n      logo: '/src/assets/logo/invision.svg',\r\n      company: 'invision',\r\n      budget: 1200,\r\n      status: 1,\r\n      progress: 90,\r\n    },\r\n    {\r\n      logo: '/src/assets/logo/jira.svg',\r\n      company: 'jira',\r\n      budget: 1200,\r\n      status: 1,\r\n      progress: 90,\r\n    },\r\n  ]);\r\n\r\n  const mapStatus = (val: number) => {\r\n    switch (val) {\r\n      case -1:\r\n        return 'exception';\r\n      case 0:\r\n        return 'pause';\r\n      case 1:\r\n        return 'working';\r\n      default:\r\n        return 'unknown';\r\n    }\r\n  };\r\n\r\n  function saveRecord(record: any) {\r\n    record._edit = false;\r\n    message.success('修改成功');\r\n  }\r\n\r\n  function extractImg(file: Blob, record: any) {\r\n    getBase64(file).then((res) => {\r\n      record.logo = res;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 新增记录\r\n   */\r\n  function addNew() {\r\n    projects.push({ progress: 10, _edit: true });\r\n  }\r\n</script>\r\n<template>\r\n  <!-- 工程 -->\r\n  <a-table\r\n    :title=\"() => '工程表格'\"\r\n    v-bind=\"$attrs\"\r\n    :columns=\"columns\"\r\n    :dataSource=\"projects\"\r\n    :pagination=\"false\"\r\n    rowClassName=\"text-subtext\"\r\n  >\r\n    <template #bodyCell=\"{ column, text, record }\">\r\n      <div class=\"flex items-center\" v-if=\"column.dataIndex === 'company'\">\r\n        <EditableCell\r\n          :options=\"{\r\n            size: 'small',\r\n            format: 'YYYY-MM-DD HH:mm',\r\n            showTime: true,\r\n          }\"\r\n          :edit=\"record._edit\"\r\n          v-model:value=\"record.company\"\r\n        >\r\n          <template #input>\r\n            <a-upload\r\n              :show-upload-list=\"false\"\r\n              :beforeUpload=\"(file: File) => extractImg(file, record)\"\r\n            >\r\n              <img\r\n                class=\"h-8 rounded border border-dashed border-border p-0.5\"\r\n                v-if=\"record.logo\"\r\n                :src=\"record.logo\"\r\n              />\r\n              <a-button v-else :loading=\"false\" type=\"dashed\">\r\n                <template #icon>\r\n                  <UploadOutlined />\r\n                </template>\r\n              </a-button>\r\n            </a-upload>\r\n            <a-input class=\"ml-2\" v-model:value=\"record.company\" />\r\n          </template>\r\n          <img class=\"w-8 rounded\" :src=\"record.logo\" />\r\n          <span class=\"ml-2 text-title text-base\">{{ record.company }}</span>\r\n        </EditableCell>\r\n      </div>\r\n      <template v-else-if=\"column.dataIndex === 'budget'\">\r\n        <EditableCell\r\n          v-model:value=\"record.budget\"\r\n          :edit=\"record._edit\"\r\n          :options=\"{\r\n            prefix: '￥',\r\n          }\"\r\n        >\r\n          ￥{{ record.budget }}\r\n        </EditableCell>\r\n      </template>\r\n      <template v-else-if=\"column.dataIndex === 'status'\">\r\n        <EditableCell\r\n          :edit=\"record._edit\"\r\n          v-model:value=\"record.status\"\r\n          type=\"select\"\r\n          :options=\"{\r\n            options: [\r\n              { label: 'exception', value: -1 },\r\n              { label: 'pause', value: 0 },\r\n              { label: 'working', value: 1 },\r\n            ],\r\n            class: 'w-24',\r\n          }\"\r\n        >\r\n          <a-badge color=\"blue\">\r\n            <template #text>\r\n              <span>{{ mapStatus(record.status) }}</span>\r\n            </template>\r\n          </a-badge>\r\n        </EditableCell>\r\n      </template>\r\n      <template v-else-if=\"column.dataIndex === 'progress'\">\r\n        <EditableCell\r\n          :edit=\"record._edit\"\r\n          v-model:value=\"record.progress\"\r\n          type=\"slider\"\r\n          :options=\"{ tooltipVisible: true }\"\r\n        >\r\n          <a-progress\r\n            :strokeWidth=\"4\"\r\n            :percent=\"record.progress\"\r\n            status=\"exception\"\r\n          />\r\n        </EditableCell>\r\n      </template>\r\n      <template v-else-if=\"column.dataIndex === 'operation'\">\r\n        <a-button type=\"link\" v-if=\"!record._edit\" @click=\"record._edit = true\">\r\n          <template #icon>\r\n            <EditFilled />\r\n          </template>\r\n          编辑\r\n        </a-button>\r\n        <a-button type=\"link\" v-else @click=\"saveRecord(record)\">\r\n          <template #icon>\r\n            <SaveOutlined />\r\n          </template>\r\n          保存\r\n        </a-button>\r\n      </template>\r\n    </template>\r\n    <template #summary>\r\n      <a-table-summary>\r\n        <a-table-summary-row>\r\n          <a-table-summary-cell colspan=\"5\">\r\n            <a-button size=\"large\" class=\"w-full\" type=\"dashed\" @click=\"addNew\">\r\n              <PlusOutlined />\r\n              新增一列\r\n            </a-button>\r\n          </a-table-summary-cell>\r\n        </a-table-summary-row>\r\n      </a-table-summary>\r\n    </template>\r\n  </a-table>\r\n</template>\r\n"],"names":["columns","text","projects","reactive","mapStatus","val","saveRecord","record","message","extractImg","file","getBase64","res","addNew"],"mappings":"0iBAYE,MAAAA,EAAA,CAAgB,CAAA,MAAA,YAAA,UAAA,SAAA,EAC6B,CAC3C,MAAA,SACS,UAAA,SACI,aAAA,CAAA,CAAA,KAAAC,CAAA,IAAA,IAAAA,GAC0B,EACvC,CAAA,MAAA,SAAA,UAAA,QAAA,EACuC,CAAA,MAAA,aAAA,UAAA,UAAA,EACM,CAAA,MAAA,YAAA,UAAA,YAAA,MAAA,IAAA,MAAA,QAAA,CAC6B,EAY5EC,EAAAC,EAAA,CAA0C,CACxC,KAAA,+BACQ,QAAA,UACG,OAAA,KACD,OAAA,EACA,SAAA,EACE,EACZ,CACA,KAAA,iCACQ,QAAA,YACG,OAAA,KACD,OAAA,EACA,SAAA,EACE,EACZ,CACA,KAAA,gCACQ,QAAA,WACG,OAAA,KACD,OAAA,EACA,SAAA,EACE,EACZ,CACA,KAAA,4BACQ,QAAA,OACG,OAAA,KACD,OAAA,EACA,SAAA,EACE,CACZ,CAAA,EAGFC,EAAAC,GAAA,CACE,OAAAA,EAAA,CAAa,IAAA,GAET,MAAA,YAAO,IAAA,GAEP,MAAA,QAAO,IAAA,GAEP,MAAA,UAAO,QAEP,MAAA,SAAO,CACX,EAGF,SAAAC,EAAAC,EAAA,CACEA,EAAA,MAAA,GACAC,EAAA,QAAA,MAAA,CAAsB,CAGxB,SAAAC,EAAAC,EAAAH,EAAA,CACEI,EAAAD,CAAA,EAAA,KAAAE,GAAA,CACEL,EAAA,KAAAK,CAAc,CAAA,CACf,CAMH,SAAAC,GAAA,CACEX,EAAA,KAAA,CAAA,SAAA,GAAA,MAAA,EAAA,CAAA,CAA2C"}