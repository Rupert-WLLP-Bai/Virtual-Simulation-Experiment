import{bU as v,m as g,c as d,e as r,f as s,B as F,g as p,bV as x,h as B,w as c,D as w,k as E,F as I,j as h,t as j,Q as A,p as K,i as O}from"./index-74898ef0.js";import{_ as y}from"./index-a749ebb9.js";import"./index-02cc34dd.js";import{_ as R}from"./index-a7f52bc9.js";import"./eagerComputed-a29f2f4d.js";import"./useBreakpoint-a031231d.js";const V={components:{"a-table":y},props:{dataSource:{type:Array,required:!0},columns:{type:Array,required:!0}},data(){return{editingKey:"",editableData:{},dataSourceCopy:this.dataSource}},methods:{update(){this.$emit("updateData",this.dataSourceCopy)},edit(e){this.editableData[e]=v(this.dataSourceCopy.filter(a=>e===a.key)[0]),this.editingKey=e,this.update()},save(e){Object.assign(this.dataSourceCopy.filter(a=>e===a.key)[0],this.editableData[e]),delete this.editableData[e],this.editingKey="",this.update()},cancel(e){delete this.editableData[e],this.editingKey="",this.update()},addRow(){const e=this.dataSourceCopy.length,a=this.columns.map(i=>i.dataIndex),o=Object.fromEntries(a.map(i=>[i,""]));o.key=e.toString(),this.dataSourceCopy.push(o),this.update()},deleteRow(e){this.dataSourceCopy=this.dataSourceCopy.filter(a=>e!==a.key),this.update()},handleDataSourceChange(e){const a=this.columns.map(o=>o.dataIndex);this.dataSourceCopy=e.map((o,i)=>Object.fromEntries(a.map(n=>[n,o[n]]))),this.update()}}};const b=e=>(K("data-v-3b665d34"),e=e(),O(),e),N={class:"container"},U={class:"editable-row-operations"},q={key:0},L=["onClick"],Q=b(()=>s("a",null,"取消",-1)),T={key:1},z=["onClick"],G=b(()=>s("a",null,"删除",-1)),H={class:"add-button"};function J(e,a,o,i,n,u){const f=A,m=R,C=y,k=w;return d(),r("div",N,[s("h1",null,[F(e.$slots,"default",{},void 0,!0)]),p(C,{columns:o.columns,pagination:!1,"data-source":n.dataSourceCopy,bordered:""},x({operation:c(({record:t})=>[s("div",U,[n.editableData[t.key]?(d(),r("span",q,[s("a",{onClick:l=>u.save(t.key),style:{margin:"10px"}},"保存",8,L),p(m,{title:"确定取消保存吗？",onConfirm:l=>u.cancel(t.key)},{default:c(()=>[Q]),_:2},1032,["onConfirm"])])):(d(),r("span",T,[s("a",{onClick:l=>u.edit(t.key),style:{margin:"10px"}},"编辑",8,z),p(m,{title:"确定删除本行吗？",onConfirm:l=>u.deleteRow(t.key)},{default:c(()=>[G]),_:2},1032,["onConfirm"])]))])]),_:2},[B(o.columns.map(t=>t.dataIndex).filter(t=>t!="operation"),(t,l)=>({name:t,fn:c(({text:D,record:_})=>[s("div",null,[n.editableData[_.key]?(d(),E(f,{key:0,value:n.editableData[_.key][t],"onUpdate:value":S=>n.editableData[_.key][t]=S,style:{margin:"-5px 0"}},null,8,["value","onUpdate:value"])):(d(),r(I,{key:1},[h(j(D),1)],64))])])}))]),1032,["columns","data-source"]),s("div",H,[p(k,{type:"primary",onClick:u.addRow},{default:c(()=>[h("增加一行")]),_:1},8,["onClick"])])])}const $=g(V,[["render",J],["__scopeId","data-v-3b665d34"]]);export{$ as default};
//# sourceMappingURL=EditableForm1-2fd3e9dc.js.map
